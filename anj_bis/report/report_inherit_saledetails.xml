<?xml version="1.0" encoding="utf-8"?>
<odoo>
	<data>
		<template id="inerit_report_saledetails" inherit_id="point_of_sale.report_saledetails">
			<xpath expr="//div[@id='sales']" position="attributes">
				<attribute name="t-if">products and not company.is_biskot</attribute>
			</xpath>
			<xpath expr="//div[@id='sales']" position="after">
				<div t-elif="company.is_biskot" id="sales">
					<t t-set="incl_vat" t-value="taxes_info['tax_amount'] + taxes_info['base_amount']"/>
					<t t-set="ht_biskot"
					   t-value='products_info["total"] - sum(spoon_data["total"] for spoon_data in spoons_data)'/>
					<t t-set="tva_biskot"
					   t-value='products_info["all_tax_amount"] - sum(spoon_data["tax_amount"] for spoon_data in spoons_data)'/>
					<t t-set="ttc_biskot"
					   t-value='products_info["all_amount_incl_vat"] - sum(spoon_data["amount_incl_vat"] for spoon_data in spoons_data)'/>
					<t t-set="ht_spoon" t-value='sum(spoon_data["total"] for spoon_data in spoons_data)'/>
					<t t-set="tva_spoon" t-value='sum(spoon_data["tax_amount"] for spoon_data in spoons_data)'/>
					<t t-set="ttc_spoon" t-value='sum(spoon_data["amount_incl_vat"] for spoon_data in spoons_data)'/>
					<h3>Sales</h3>
					<div class="oe_structure"></div>
					<table class="table table-sm">
						<thead>
							<tr>
								<th class="text-start">Product Category</th>
								<th class="text-start">Product</th>
								<th class="text-end">Quantity</th>
								<th class="text-end">Total (Tax excluded)</th>
								<th class="text-end">VAT amount</th>
								<th class="text-end">Amount incl VAT</th>
							</tr>
						</thead>
						<tbody>
							<tr t-foreach="products" t-as="category">
								<td style="background-color: #dadada;">
									<span t-out="category['name']">Technical Stuffs</span>
								</td>
								<td style="background-color: #dadada;"/>
								<td class="text-end" style="background-color: #dadada;">
									<span t-out="category['qty']">5</span>
								</td>
								<td class="text-end" style="background-color: #dadada;">
									<t t-if="currency['position']">
										<span t-out="category['total']" t-options="{'widget': 'float', 'precision': currency['precision']}">
											10000.00
										</span>
										<span t-out='currency["symbol"]'>$</span>
									</t>
									<t t-else="">
										<span t-out='currency["symbol"]'>$</span>
										<span t-out="category['total']" t-options="{'widget': 'float', 'precision': currency['precision']}">
											10000.00
										</span>
									</t>
								</td>
								<td class="text-end" style="background-color: #dadada;">
									<t t-if="currency['position']">
										<span t-out="category['tax_amount']"
										      t-options="{'widget': 'float', 'precision': currency['precision']}">10000.00
										</span>
										<span t-out='currency["symbol"]'>$</span>
									</t>
									<t t-else="">
										<span t-out='currency["symbol"]'>$</span>
										<span t-out="category['tax_amount']"
										      t-options="{'widget': 'float', 'precision': currency['precision']}">10000.00
										</span>
									</t>
								</td>
								<td class="text-end" style="background-color: #dadada;">
									<t t-if="currency['position']">
										<span t-out="category['amount_incl_vat']"
										      t-options="{'widget': 'float', 'precision': currency['precision']}">10000.00
										</span>
										<span t-out='currency["symbol"]'>$</span>
									</t>
									<t t-else="">
										<span t-out='currency["symbol"]'>$</span>
										<span t-esc="category['amount_incl_vat']"
										      t-options="{'widget': 'float', 'precision': currency['precision']}">10000.00
										</span>
									</t>
								</td>
								<tr t-foreach="category['products']" t-as="line">
									<td/>
									<t t-set="internal_reference" t-value="line['code'] and '[%s] ' % line['code'] or ''"/>
									<td>
										<span t-out="internal_reference">Ref 876787</span>
										<span t-out="line['product_name']">Laptop model x</span>
									</td>
									<td class="text-end">
										<span t-out="line['quantity']">5</span>
										<t t-if='line["uom"] != "Units"'>
											<span t-out='line["uom"]'>Unit</span>
										</t>
									</td>
									<td class="text-end">
										<t t-if="currency['position']">
											<span t-out='line["base_amount"]'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">567789
											</span>
											<span t-out='currency["symbol"]'>$</span>
										</t>
										<t t-else="">
											<span t-out='currency["symbol"]'>$</span>
											<span t-out='line["base_amount"]'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">567789
											</span>
										</t>

										<t t-if='line["discount"] != 0'>
											Disc: <span t-out='line["discount"]'>45</span>%
										</t>
									</td>
									<td class="text-end">
										<t t-if="currency['position']">
											<span t-out='line["tax_amount"]'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">567789
											</span>
											<span t-out='currency["symbol"]'>$</span>
										</t>
										<t t-else="">
											<span t-out='currency["symbol"]'>$</span>
											<span t-out='line["tax_amount"]'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">567789
											</span>
										</t>

									</td>
									<td class="text-end">
										<t t-if="currency['position']">
											<span t-out='line["amount_incl_vat"]'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">567789
											</span>
											<span t-out='currency["symbol"]'>$</span>
										</t>
										<t t-else="">
											<span t-out='currency["symbol"]'>$</span>
											<span t-out='line["amount_incl_vat"]'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">567789
											</span>
										</t>
									</td>
								</tr>
							</tr>
							<tr>
								<td style="background-color: #b1b1b1;">
									<strong>Total Biskot</strong>
								</td>
								<td style="background-color: #b1b1b1;"/>
								<td class="text-end" style="background-color: #b1b1b1;">
									<strong>
										<span t-out="products_info['qty'] - sum(spoon_data['qty'] for spoon_data in spoons_data)">5</span>
									</strong>
								</td>
								<td class="text-end" style="background-color: #b1b1b1;">
									<t t-if="currency['position']">
										<strong>
											<span t-out='products_info["total"] - sum(spoon_data["total"] for spoon_data in spoons_data)'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">10000
											</span>
											<span t-out='currency["symbol"]'>$</span>
										</strong>
									</t>
									<t t-else="">
										<strong>
											<span t-out='currency["symbol"]'>$</span>
											<span t-out='products_info["total"] - sum(spoon_data["total"] for spoon_data in spoons_data)'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">1000
											</span>
										</strong>
									</t>
								</td>
								<td class="text-end" style="background-color: #b1b1b1;">
									<t t-if="currency['position']">
										<strong>
											<span
												t-out='products_info["all_tax_amount"] - sum(spoon_data["tax_amount"] for spoon_data in spoons_data)'
												t-options="{'widget': 'float', 'precision': currency['precision']}">10000
											</span>
											<span t-out='currency["symbol"]'>$</span>
										</strong>
									</t>
									<t t-else="">
										<strong>
											<span t-out='currency["symbol"]'>$</span>
											<span
												t-out='products_info["all_tax_amount"] - sum(spoon_data["tax_amount"] for spoon_data in spoons_data)'
												t-options="{'widget': 'float', 'precision': currency['precision']}">1000
											</span>
										</strong>
									</t>
								</td>
								<td class="text-end" style="background-color: #b1b1b1;">
									<t t-if="currency['position']">
										<strong>
											<span
												t-out='products_info["all_amount_incl_vat"] - sum(spoon_data["amount_incl_vat"] for spoon_data in spoons_data)'
												t-options="{'widget': 'float', 'precision': currency['precision']}">10000
											</span>
											<span t-out='currency["symbol"]'>$</span>
										</strong>
									</t>
									<t t-else="">
										<strong>
											<span t-out='currency["symbol"]'>$</span>
											<span
												t-out='products_info["all_amount_incl_vat"] - sum(spoon_data["amount_incl_vat"] for spoon_data in spoons_data)'
												t-options="{'widget': 'float', 'precision': currency['precision']}">1000
											</span>
										</strong>
									</t>
								</td>
							</tr>
						</tbody>
					</table>

					<table class="table table-sm">
						<thead>
							<tr>
								<th class="text-start">Product Category</th>
								<th class="text-start">Product</th>
								<th class="text-end">Quantity</th>
								<th class="text-end">Total (Tax excluded)</th>
								<th class="text-end">VAT amount</th>
								<th class="text-end">Amount incl VAT</th>
							</tr>
						</thead>
						<tbody>
							<tr t-foreach="spoons_data" t-as="category">
								<td style="background-color: #dadada;">
									<span t-out="category['name']">Technical Stuffs</span>
								</td>
								<td style="background-color: #dadada;"/>
								<td class="text-end" style="background-color: #dadada;">
									<span t-out="category['qty']">5</span>
								</td>
								<td class="text-end" style="background-color: #dadada;">
									<t t-if="currency['position']">
										<span t-out="category['total']" t-options="{'widget': 'float', 'precision': currency['precision']}">
											10000.00
										</span>
										<span t-out='currency["symbol"]'>$</span>
									</t>
									<t t-else="">
										<span t-out='currency["symbol"]'>$</span>
										<span t-out="category['total']" t-options="{'widget': 'float', 'precision': currency['precision']}">
											10000.00
										</span>
									</t>
								</td>
								<td class="text-end" style="background-color: #dadada;">
									<t t-if="currency['position']">
										<span t-out="category['tax_amount']"
										      t-options="{'widget': 'float', 'precision': currency['precision']}">10000.00
										</span>
										<span t-out='currency["symbol"]'>$</span>
									</t>
									<t t-else="">
										<span t-out='currency["symbol"]'>$</span>
										<span t-out="category['tax_amount']"
										      t-options="{'widget': 'float', 'precision': currency['precision']}">10000.00
										</span>
									</t>
								</td>
								<td class="text-end" style="background-color: #dadada;">
									<t t-if="currency['position']">
										<span t-out="category['amount_incl_vat']"
										      t-options="{'widget': 'float', 'precision': currency['precision']}">10000.00
										</span>
										<span t-out='currency["symbol"]'>$</span>
									</t>
									<t t-else="">
										<span t-out='currency["symbol"]'>$</span>
										<span t-out="category['amount_incl_vat']"
										      t-options="{'widget': 'float', 'precision': currency['precision']}">10000.00
										</span>
									</t>
								</td>
								<tr t-foreach="category['products']" t-as="line">
									<td/>
									<t t-set="internal_reference" t-value="line['code'] and '[%s] ' % line['code'] or ''"/>
									<td>
										<span t-out="internal_reference">Ref 876787</span>
										<span t-out="line['product_name']">Laptop model x</span>
									</td>
									<td class="text-end">
										<span t-out="line['quantity']">5</span>
										<t t-if='line["uom"] != "Units"'>
											<span t-out='line["uom"]'>Unit</span>
										</t>
									</td>
									<td class="text-end">
										<t t-if="currency['position']">
											<span t-out='line["base_amount"]'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">567789
											</span>
											<span t-out='currency["symbol"]'>$</span>
										</t>
										<t t-else="">
											<span t-out='currency["symbol"]'>$</span>
											<span t-out='line["base_amount"]'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">567789
											</span>
										</t>

										<t t-if='line["discount"] != 0'>
											Disc: <span t-out='line["discount"]'>45</span>%
										</t>
									</td>
									<td class="text-end">
										<t t-if="currency['position']">
											<span t-out='line["tax_amount"]'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">567789
											</span>
											<span t-out='currency["symbol"]'>$</span>
										</t>
										<t t-else="">
											<span t-out='currency["symbol"]'>$</span>
											<span t-out='line["tax_amount"]'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">567789
											</span>
										</t>
									</td>
									<td class="text-end">
										<t t-if="currency['position']">
											<span t-out='line["amount_incl_vat"]'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">567789
											</span>
											<span t-out='currency["symbol"]'>$</span>
										</t>
										<t t-else="">
											<span t-out='currency["symbol"]'>$</span>
											<span t-out='line["amount_incl_vat"]'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">567789
											</span>
										</t>
									</td>
								</tr>
							</tr>
							<tr>
								<td style="background-color: #b1b1b1;">
									<strong>Total Spoon</strong>
								</td>
								<td style="background-color: #b1b1b1;"/>
								<td class="text-end" style="background-color: #b1b1b1;">
									<strong>
										<span t-out="sum(spoon_data['qty'] for spoon_data in spoons_data)">5</span>
									</strong>
								</td>
								<td class="text-end" style="background-color: #b1b1b1;">
									<t t-if="currency['position']">
										<strong>
											<span t-out='sum(spoon_data["total"] for spoon_data in spoons_data)'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">10000
											</span>
											<span t-out='currency["symbol"]'>$</span>
										</strong>
									</t>
									<t t-else="">
										<strong>
											<span t-out='currency["symbol"]'>$</span>
											<span t-out='sum(spoon_data["total"] for spoon_data in spoons_data)'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">1000
											</span>
										</strong>
									</t>
								</td>
								<td class="text-end" style="background-color: #b1b1b1;">
									<t t-if="currency['position']">
										<strong>
											<span t-out='sum(spoon_data["tax_amount"] for spoon_data in spoons_data)'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">10000
											</span>
											<span t-out='currency["symbol"]'>$</span>
										</strong>
									</t>
									<t t-else="">
										<strong>
											<span t-out='currency["symbol"]'>$</span>
											<span t-out='sum(spoon_data["tax_amount"] for spoon_data in spoons_data)'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">1000
											</span>
										</strong>
									</t>
								</td>
								<td class="text-end" style="background-color: #b1b1b1;">
									<t t-if="currency['position']">
										<strong>
											<span t-out='sum(spoon_data["amount_incl_vat"] for spoon_data in spoons_data)'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">10000
											</span>
											<span t-out='currency["symbol"]'>$</span>
										</strong>
									</t>
									<t t-else="">
										<strong>
											<span t-out='currency["symbol"]'>$</span>
											<span t-out='sum(spoon_data["amount_incl_vat"] for spoon_data in spoons_data)'
											      t-options="{'widget': 'float', 'precision': currency['precision']}">1000
											</span>
										</strong>
									</t>
								</td>
							</tr>
						</tbody>
					</table>

				</div>
			</xpath>
			<xpath expr="//t[@id='payments']" position="before">
				<t t-set="ht_qty_biskot"
				   t-value="(products_info['qty'] - sum(spoon_data['qty'] for spoon_data in spoons_data))"/>
				<t t-set="ht_qty_spoon" t-value="(sum(spoon_data['qty'] for spoon_data in spoons_data))"/>
				<t t-set="average_total_basket" t-value="currency['total_paid']/nbr_orders if nbr_orders else 0"/>
				<t t-set="average_total_basket_biskot" t-value="ttc_biskot/nbr_orders if nbr_orders else 0"/>
				<t t-set="average_total_basket_spoon" t-value="ttc_spoon/nbr_orders if nbr_orders else 0"/>
				<div t-if="company.is_biskot">
					<div>
						<span>Total average basket:</span>
						<span t-esc="average_total_basket" t-options="{'widget': 'float', 'precision': currency['precision']}"/>
						<span t-out='currency["symbol"]'>$</span>
					</div>
					<div>
						<span>Total average basket Biskot:</span>
						<span t-esc="average_total_basket_biskot"
						      t-options="{'widget': 'float', 'precision': currency['precision']}"/>
						<span t-out='currency["symbol"]'>$</span>
					</div>
					<div>
						<span>Total average basket speon:</span>
						<span t-esc="average_total_basket_spoon"
						      t-options="{'widget': 'float', 'precision': currency['precision']}"/>
						<span t-out='currency["symbol"]'>$</span>
					</div>
				</div>
			</xpath>
			<xpath expr="//t[@id='closing_session']/div[2]/strong[2]" position="replace">
				<t t-if="company.is_biskot">
					<strong>Receipt number:
						<span t-out="nbr_orders">10</span>
					</strong>
				</t>
				<t t-else="">
					<strong>Number of transactions:
						<span t-out="nbr_orders">10</span>
					</strong>
				</t>
			</xpath>
			<xpath expr="//t[@id='closing_session']" position="after">
				<t t-if="company.is_biskot">
					<t t-if="payments_method">
						<table class="table table-bordered">
							<tr>
								<td/>
								<t t-foreach="payments_method" t-as="method">
									<td t-esc="method.name"/>
								</t>
							</tr>
							<t t-foreach="['biskot', 'spoon']" t-as="item">
								<tr>
									<td t-esc="'CA TTC ' + item.capitalize()"/>
									<t t-foreach="payments_method" t-as="method">
										<td>
											<span t-esc="payments_by_method[item][method]"
											      t-options="{'widget': 'float', 'precision': currency['precision']}"/>
											<span t-out='currency["symbol"]'>$</span>
										</td>
									</t>
								</tr>
							</t>
							<tr>
								<td>Total CA TTC</td>
								<t t-foreach="payments_method" t-as="method">
									<td>
										<span t-esc="payments_by_method['spoon'][method] + payments_by_method['biskot'][method]"
										      t-options="{'widget': 'float', 'precision': currency['precision']}"/>
										<span t-out='currency["symbol"]'>$</span>
									</td>
								</t>
							</tr>
						</table>
					</t>
					<table class="table table-bordered">
						<tr>
							<td/>
							<td>Biskot</td>
							<td>Spoon</td>
						</tr>
						<tr>
							<td>CA HT</td>
							<td>
								<span t-out='ht_biskot' t-options="{'widget': 'float', 'precision': currency['precision']}"/>
								<span t-out='currency["symbol"]'>$</span>
							</td>
							<td>
								<span t-out='ht_spoon' t-options="{'widget': 'float', 'precision': currency['precision']}"/>
								<span t-out='currency["symbol"]'>$</span>
							</td>
						</tr>
						<tr>
							<td>TVA</td>
							<td>
								<span t-out='tva_biskot' t-options="{'widget': 'float', 'precision': currency['precision']}"/>
								<span t-out='currency["symbol"]'>$</span>
							</td>

							<td>
								<span t-out='tva_spoon' t-options="{'widget': 'float', 'precision': currency['precision']}"/>
								<span t-out='currency["symbol"]'>$</span>
							</td>

						</tr>
						<tr>
							<td>CA TTC</td>
							<td>
								<span t-out='ttc_biskot' t-options="{'widget': 'float', 'precision': currency['precision']}"/>
								<span t-out='currency["symbol"]'>$</span>
							</td>
							<td>
								<span t-out='ttc_spoon' t-options="{'widget': 'float', 'precision': currency['precision']}"/>
								<span t-out='currency["symbol"]'>$</span>
							</td>

						</tr>
						<tr>
							<td>10% royalty</td>
							<td>
								<span t-esc="(ht_biskot * 10)/100" t-options="{'widget': 'float', 'precision': currency['precision']}"/>
								<span t-out='currency["symbol"]'>$</span>
							</td>
							<td>
								<span t-esc="(ht_spoon * 10)/100" t-options="{'widget': 'float', 'precision': currency['precision']}"/>
								<span t-out='currency["symbol"]'>$</span>
							</td>
						</tr>
					</table>
				</t>

			</xpath>
		</template>
	</data>
</odoo>
